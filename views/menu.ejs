<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8"><!-- Spécifie l'encodage des caractères en UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Assure une bonne mise en page sur mobile -->
    <title>Menu - Jardin des Fleur:</title><!-- Titre de la page affiché dans l'onglet du navigateur -->
    <link rel="stylesheet" href="css/menu.css"><!-- Lien vers le fichier CSS externe -->
</head>
<body>
    <%- include("navbar") -%>

    <h3>Créer un nouveau plat</h3>
    <form action="/plat" methode="post"><!-- Création du formulaire-->
      <input type="hidden" name="id" id="id">
        <label for="nomplat">Nom du plat:</label>
        <input type="text" id="nomplat" name="nom"><br>
        <label for="prixplat">prix</label><br>
        <input type="number" id="prix" name="prix"><br><br>
        <input type="submit" value="Enregistrer">
    </form>
    <!-- Section principale du menu -->
    <main>
        <h1>Notre Menu</h1> <!-- Titre principal de la page -->
        <% resultat.forEach(plat => { %> <!-- Boucle pour afficher chaque plat -->
            <div>
                <p><%= plat.nom %></p> <!-- Affiche le nom du plat -->
                <span><%= plat.prix %> €</span> <!-- Affiche le prix du plat -->
                <!-- Bouton Supprimer avec appel à la fonction -->
                <input type="button" value="Supprimer" onclick="supprimerDonnees('<%= plat.id %>')">  <!-- Bouton Supprimer -->
                <input type="button" value="Modifier" onclick="rempliDoonees('<%= plat.id %>', '<%= plat.nom %>', '<%= plat.prix %>')"> <!-- Correctement fermé -->
            </div>
        <% }); %>
    </main>
    
    
    
        <!-- Liste des plats -->
        <section class="menu-list">
            <article class="menu-item">
                <img src="" alt="Entrée Salade César" class="menu-img">
                <div class="menu-info">
                    <h2>Salade César</h2>
                    <p class="price">10 </p>
                    <p>Une salade fraîche avec laitue croquante, poulet grillé, croûtons, et sauce César maison.</p>
                </div>
            </article>

            <article class="menu-item">
                <img src="" alt="Entrée Soupe à l'oignon" class="menu-img">
                <div class="menu-info">
                    <h2>Soupe à l'oignon</h2>
                    <p class="price">8 </p>
                    <p>Une soupe traditionnelle à l'oignon gratinée au fromage, servie avec du pain frais.</p>
                </div>
            </article>

            <article class="menu-item">
                <img src="" alt="Plat Bœuf Bourguignon" class="menu-img">
                <div class="menu-info">
                    <h2>Bœuf Bourguignon</h2>
                    <p class="price">18 </p>
                    <p>Un classique de la cuisine française, mijoté lentement dans du vin rouge, accompagné de légumes frais.</p>
                </div>
            </article>

            <article class="menu-item">
                <img src="" alt="Plat Pizza Margherita" class="menu-img">
                <div class="menu-info">
                    <h2>Pizza Margherita</h2>
                    <p class="price">12 </p>
                    <p>Une pizza classique à la tomate, mozzarella fondue, et basilic frais.</p>
                </div>
            </article>

            <!-- Ajouter d'autres plats ici -->

        </section>
    </main>

    <!-- Pied de page -->
    <footer>
        
    </footer>
    <%- include("footer") -%>
</body>
<script>
    function rempliDoonees(id,nom,prix){
        document.querySelector("#id").value = id;
        document.querySelector("#nomplat").value = nom;
        document.querySelector("#prix").value = prix;
    }
    function supprimerDonnees(id) {
        let routeComplete = "plat/" + id;

        fetch(
            routeComplete, {method : "DELETE"},
            console.log("affichier fetch1")
        ).then(
            (response) => response.json(),
            console.log("response.json")
        ).then(
            (donnee) => window.location.href = donnee.routeRacine // Redirige si routeRacine existe
        ).catch((erreur) => console.log(erreur))  // Gère les erreurs réseau ou logiques
    } 
</script>
</html>